
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بيان الخارجي</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
:root {
    --primary-color: #0B7285;
    --primary-light: #3A9EAF;
    --primary-dark: #065666;
    --secondary-color: #0CA678;
    --secondary-light: #96F2D7;
    --text-color: #2D3748;
    --background-color: #E6FFFA;
    --card-color: #FFFFFF;
    --hover-color: #C3FAE8;
    --error-color: #E53E3E;
    --success-color: #38A169;
    --border-radius: 12px;
    --box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}

body {
    font-family: 'Roboto', sans-serif;
    margin: 0;
    padding: 20px;
    background-color: var(--background-color);
    color: var(--text-color);
    line-height: 1.6;
}

.card {
    background-color: var(--card-color);
    border-radius: var(--border-radius);
    padding: 28px;
    box-shadow: var(--box-shadow);
    margin-bottom: 24px;
    transition: var(--transition);
    width: 100%;
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
}

.card:hover {
    box-shadow: 0 8px 12px rgba(0,0,0,0.15);
}

.hidden {
    display: none;
}

button {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 12px 24px;
    margin: 8px 5px;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 500;
    text-transform: uppercase;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

button:hover {
    background-color: var(--primary-dark);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transform: translateY(-2px);
}

select, input[type="text"], input[type="number"] {
    width: 100%;
    padding: 14px;
    margin: 10px 0;
    border: 2px solid var(--primary-light);
    border-radius: var(--border-radius);
    font-size: 16px;
    transition: var(--transition);
    background-color: #FAFAFA;
    box-sizing: border-box;
}

select:focus, input[type="text"]:focus, input[type="number"]:focus {
    outline: none;
    border-color: var(--secondary-color);
    box-shadow: 0 0 0 3px var(--secondary-light);
}

select:required:invalid,
input[type="number"]:required:invalid {
    color: #999;
    border-color: var(--error-color);
    background-color: #FFF5F5;
}

select option[value=""][disabled] {
    display: none;
}

select option {
    color: var(--text-color);
}

#searchBar {
    font-size: 18px;
    width: 100%;
    margin: 24px 0;
    padding: 16px 22px;
    border: 3px solid var(--primary-color);
    border-radius: 30px;
    transition: var(--transition);
    background-color: white;
    box-shadow: var(--box-shadow);
    box-sizing: border-box;
}

#searchBar:focus {
    border-color: var(--secondary-color);
    box-shadow: 0 0 0 4px var(--secondary-light), 0 4px 8px rgba(0,0,0,0.1);
    outline: none;
}

#suggestions, #didYouMean {
    background-color: var(--card-color);
    border: 1px solid var(--primary-light);
    border-radius: var(--border-radius);
    max-height: 220px;
    overflow-y: auto;
    box-shadow: var(--box-shadow);
    margin-top: 12px;
}

#suggestions div, #didYouMean div {
    padding: 14px 22px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#suggestions div:hover, #didYouMean div:hover {
    background-color: var(--hover-color);
}

.title-container {
    text-align: center;
    margin-bottom: 30px;
    padding: 30px;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    border-radius: var(--border-radius);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.title {
    font-size: 64px;
    color: var(--primary-color);
    margin: 0 auto;
    font-weight: 700;
    text-transform: uppercase;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    letter-spacing: 2px;
    text-align: center;
    max-width: 80%;
}

.subtitle {
    font-size: 22px;
    color: var(--secondary-light);
    margin-top: 15px;
    font-weight: 400;
    text-align: center;
}

table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin-top: 24px;
    box-shadow: var(--box-shadow);
    border-radius: var(--border-radius);
    overflow: hidden;
    background-color: var(--card-color);
}

th, td {
    border: none;
    padding: 18px;
    text-align: left;
    position: relative;
}

th {
    background-color: var(--primary-color);
    color: white;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

tr {
    transition: var(--transition);
}

tr:nth-child(even) {
    background-color: rgba(0, 0, 0, 0.02);
}

tr:hover {
    background-color: var(--hover-color);
}

td.editable {
    position: relative;
    padding-right: 40px;
}

td:nth-child(2) {
    position: relative;
}

td:nth-child(2)::after {
    content: '✎';
    position: absolute;
    right: -10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 24px;
    color: var(--primary-color);
    opacity: 0.7;
    transition: var(--transition);
    background-color: transparent;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

td:nth-child(2):hover::after {
    color: var(--primary-dark);
    opacity: 1;
    background-color: var(--secondary-light);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transform: translateY(-50%) scale(1.1);
}

td.editable.editing::after {
    opacity: 0;
}

td.editable input {
    width: calc(100% - 30px);
    padding: 8px;
    margin: 0;
    border: 1px solid transparent;
    background-color: transparent;
    font-size: inherit;
    transition: var(--transition);
}

td.editable input:focus {
    outline: none;
    border-color: var(--secondary-color);
    background-color: white;
    box-shadow: 0 0 0 3px var(--secondary-light);
}

td input[type="number"]::-webkit-inner-spin-button, 
td input[type="number"]::-webkit-outer-spin-button { 
    -webkit-appearance: none; 
    margin: 0; 
}

td input[type="number"] {
    -moz-appearance: textfield;
}

.duplicate {
    color: var(--error-color);
}

.highlight {
    background-color: var(--secondary-light);
    font-weight: bold;
}

#idInfo {
    background-color: var(--primary-light);
    padding: 18px;
    border-radius: var(--border-radius);
    margin-bottom: 24px;
    color: white;
    box-shadow: var(--box-shadow);
}

.material-icons {
    vertical-align: middle;
    margin-right: 10px;
}

.pharmacy-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 18px;
    margin-top: 18px;
}

.pharmacy-item {
    background-color: var(--card-color);
    color: var(--text-color);
    padding: 18px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    transition: var(--transition);
}

.pharmacy-item:hover {
    box-shadow: 0 6px 10px rgba(0,0,0,0.15);
    transform: translateY(-2px);
    background-color: var(--hover-color);
}

.class-btn.selected {
    background-color: var(--primary-dark);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.class-btn:not(.selected) {
    opacity: 0.5;
    cursor: not-allowed;
}

.action-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: var(--transition);
}

.action-btn:hover {
    background-color: var(--primary-dark);
}

.delete-btn {
    background-color: var(--error-color);
}

.delete-btn:hover {
    background-color: #C53030;
}

.example-id {
    cursor: pointer;
    color: var(--primary-color);
    text-decoration: underline;
}

.example-id:hover {
    color: var(--primary-dark);
}

.submit-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 20px;
}

.submit-hint {
    background-color: var(--secondary-light);
    color: var(--primary-dark);
    padding: 10px 15px;
    border-radius: var(--border-radius);
    font-size: 14px;
    max-width: 300px;
}

@media (max-width: 1200px) {
    .card {
        max-width: 900px;
    }
}

@media (max-width: 992px) {
    .card {
        max-width: 100%;
    }
}

@media (max-width: 768px) {
    body {
        padding: 12px;
    }
    .card {
        padding: 22px;
    }
    .pharmacy-list {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }
    table {
        font-size: 14px;
    }
    th, td {
        padding: 14px 10px;
    }
    #searchBar {
        font-size: 16px;
        padding: 14px 18px;
    }
    select, input[type="text"], input[type="number"] {
        padding: 12px;
        font-size: 14px;
    }
    .submit-container {
        flex-direction: column;
        align-items: stretch;
    }
    .submit-hint {
        margin-top: 10px;
        max-width: none;
    }
    .title {
        font-size: 48px;
    }
    .subtitle {
        font-size: 18px;
    }
}

@media (max-width: 480px) {
    .pharmacy-list {
        grid-template-columns: 1fr;
    }
    button {
        width: 100%;
        margin: 6px 0;
    }
    #idInfo {
        font-size: 14px;
    }
    #searchBar {
        font-size: 14px;
        padding: 12px 16px;
    }
    select, input[type="text"], input[type="number"] {
        padding: 10px;
        font-size: 13px;
    }
    .title {
        font-size: 36px;
    }
    .subtitle {
        font-size: 16px;
    }
}
    </style>
</head>
<body>
    <div id="screen1" class="card">
        <h1 class="title">بيان الخارجي</h1>
        <div id="idInfo">
            <i class="material-icons">info</i>
            <strong>ID Format:</strong> You can use id for autofill or use the dropdowns :
            <ul>
                <li>1st character: 'a' for student, 'b' for workforce</li>
                <li>2nd character: '1' for first region, '2' for second, '3' for third</li>
                <li>3rd character: Specific pharmacy number</li>
            </ul>
            <div class="pharmacy-list" id="pharmacyList"></div>
        </div>
        <input type="text" id="id" placeholder="ID (e.g., a21)">
        <div>
            <button class="class-btn" data-class="student">Student</button>
            <button class="class-btn" data-class="workforce">Workforce</button>
        </div>
        <select id="region" required>
            <option value="" disabled selected>Select Region</option>
            <option value="first">First</option>
            <option value="second">Second</option>
            <option value="third">Third</option>
        </select>
        <select id="pharmacy" required>
            <option value="" disabled selected>Select Pharmacy</option>
        </select>
       <input type="number" id="month" placeholder="Month (1-12)" min="1" max="12" required>
        <button id="nextBtn">Next</button>
    </div>

    <div id="screen2" class="card hidden">
        <button id="backBtn"><i class="material-icons">arrow_back</i>Go Back</button>
        <input type="text" id="searchBar" placeholder="Search...">
        <div id="didYouMean"></div>
        <div id="suggestions"></div>
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Unit</th>
                    <th>Units Sold</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table body will be populated dynamically -->
            </tbody>
        </table>
        <div class="submit-container">
            <button id="submitBtn"><i class="material-icons">send</i>Submit</button>
<div class="submit-hint">
    Please note: Review your data carefully before submission.<br>
    Ensure you submit all your data in one session.<br>
</div>
        </div>
    </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>

const firebaseConfig = {
  apiKey: "AIzaSyBYmguP4MPNvKV3ZeoR-MploiVZKgyAga8",
  authDomain: "the-other-plan.firebaseapp.com",
  databaseURL: "https://the-other-plan-default-rtdb.firebaseio.com",
  projectId: "the-other-plan",
  storageBucket: "the-other-plan.appspot.com",
  messagingSenderId: "465003350934",
  appId: "1:465003350934:web:ca48924ffad36396cf6bb7",
  measurementId: "G-6LVGSBLK09"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Cache DOM elements
const screen1 = document.getElementById('screen1');
const screen2 = document.getElementById('screen2');
const idInput = document.getElementById('id');
const classButtons = document.querySelectorAll('.class-btn');
const regionSelect = document.getElementById('region');
const pharmacySelect = document.getElementById('pharmacy');
const monthInput = document.getElementById('month');
const nextBtn = document.getElementById('nextBtn');
const backBtn = document.getElementById('backBtn');
const searchBar = document.getElementById('searchBar');
const suggestions = document.getElementById('suggestions');
const didYouMean = document.getElementById('didYouMean');
const dataTable = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
const submitBtn = document.getElementById('submitBtn');
const pharmacyList = document.getElementById('pharmacyList');
const confirmModal = document.getElementById('confirmModal');
const cancelSubmit = document.getElementById('cancelSubmit');
const confirmSubmit = document.getElementById('confirmSubmit');

// State
let selectedClass = '';
let selectedItems = [];
let isSubmitting = false;

const items = [
    { name: "5-Fluorouracil 250mg", unit: "Amp", price: 12 },
    { name: "Acetazolamide 250mg", unit: "10 T", price: 12 },
    { name: "Acetylcysteine Sachets", unit: "10 Sach", price: 12 },
    { name: "Acetylsalicylic Acid 75mg", unit: "10 T", price: 12 },
    { name: "Acetylsalicylic Acid 81mg", unit: "10 T", price: 12 },
    { name: "Acyclovir 0.05 cream", unit: "Tube", price: 12 },
    { name: "Acyclovir 400mg", unit: "10 T", price: 12 },
    { name: "Aescin gel", unit: "Tube", price: 12 },
    { name: "Allopurinol 100mg", unit: "10 T", price: 12 },
    { name: "Allopurinol 300mg", unit: "10 T", price: 12 },
    { name: "Alpha Chymotrypsin", unit: "Amp", price: 12 },
    { name: "Alpha Lipoic Acid 300mg", unit: "10 T", price: 12 },
    { name: "Alpha Lipoic Acid 600mg", unit: "10 T", price: 12 },
    { name: "Amantadine HCL 100mg", unit: "10 T", price: 12 },
    { name: "Amaryl 2mg (حكم قضائي)", unit: "30 T", price: 12 },
    { name: "Ambroxol", unit: "10 T", price: 12 },
    { name: "Ambroxol Syp", unit: "B", price: 12 },
    { name: "Amiloride 5mg & HCT 50mg", unit: "10T", price: 12 },
    { name: "Amiodarone 200mg", unit: "10 T", price: 12 },
    { name: "Amitriptyline 10mg", unit: "10 T", price: 12 },
    { name: "Amitriptyline 25mg", unit: "10 T", price: 12 },
    { name: "Amlodipine 10mg", unit: "10T", price: 12 },
    { name: "Amlodipine 5mg", unit: "10 T", price: 12 },
    { name: "Amlodipine 5mg & Olmesartan 20mg", unit: "10 T", price: 12 },
    { name: "Amlodipine, Olmesartan & HCT 10/40/25mg", unit: "10 T", price: 12 },
    { name: "Amlodipine, Olmesartan & HCT 5/20/12.5mg", unit: "10 T", price: 12 },
    { name: "Amoxicillin & Clavulanic acid 1 gm", unit: "10 T", price: 12 },
    { name: "Amoxicillin 500mg", unit: "10 Cap", price: 12 },
    { name: "Anagrelide 0.5mg", unit: "10 T", price: 12 },
    { name: "Andovimpamide 100mg (استثناء من مدير الفرع)", unit: "10 T", price: 12 },
    { name: "Antacid", unit: "10 T", price: 12 },
    { name: "Antacid Syp", unit: "B", price: 12 },
    { name: "Anti-migraine", unit: "10 T", price: 12 },
    { name: "Antibiotic & Corticosteroid cream", unit: "Tube", price: 12 },
    { name: "Antifungal cream", unit: "Tube", price: 12 },
    { name: "Antirheumatic gel", unit: "Tube", price: 12 },
    { name: "Antispasmodic", unit: "10T", price: 12 },
    { name: "Apetryl 0.5mg (تم الصرف بالاسم التجاري وفقا لتأشيرة الشئون الطبية)", unit: "10 T", price: 12 },
    { name: "Apixaban 2.5mg", unit: "10 T", price: 12 },
    { name: "Apixaban 5mg", unit: "10 T", price: 12 },
    { name: "Aranesp 100mcg", unit: "Syringe", price: 12 },
    { name: "Aripiprazole 30mg", unit: "10 T", price: 12 },
    { name: "Artificial Tears", unit: "B", price: 12 },
    { name: "Atorvastatin & Ezetimibe 10/10 mg", unit: "10 T", price: 12 },
    { name: "Atorvastatin & Ezetimibe 20/10 mg", unit: "10 T", price: 12 },
    { name: "Atorvastatin & Ezetimibe 40/10 mg", unit: "10 T", price: 12 },
    { name: "Atorvastatin 10mg", unit: "10 T", price: 12 },
    { name: "Atorvastatin 20mg", unit: "10 T", price: 12 },
    { name: "Atorvastatin 40mg", unit: "10 T", price: 12 },
    { name: "Atropine Sulphate ED", unit: "B", price: 12 },
    { name: "Atropine Sulphate, Colchicine & Piperazine Sachets", unit: "12 Sach", price: 12 },
    { name: "Avonex 30mcg (قرار لجنة)", unit: "Syringe", price: 12 },
    { name: "Azathioprine 50 mg", unit: "10 T", price: 12 },
    { name: "Beclomethasone & Salbutamol Inhalation", unit: "B", price: 12 },
    { name: "Beclomethasone Inhalation", unit: "B", price: 12 },
    { name: "Bendamustin 100mg", unit: "vial", price: 12 },
    { name: "Benztropine 2mg", unit: "10 T", price: 12 },
    { name: "Benzyl benzoate cream", unit: "Tube", price: 12 },
    { name: "Betaferon (قرار لجنة)", unit: "Syringe", price: 12 },
    { name: "Betahistine 8mg", unit: "10 T", price: 12 },
    { name: "Betamethasone & Calcipotriol Cr.", unit: "Tube", price: 12 },
    { name: "Betamethasone & Salicylic acid Lotion", unit: "B", price: 12 },
    { name: "Betamethasone & Salicylic acid Oint.", unit: "Tube", price: 12 },
    { name: "Betamethasone Cr.", unit: "Tube", price: 12 },
    { name: "Betaxolol", unit: "B", price: 12 },
    { name: "Bilichol", unit: "12 Cap", price: 12 },
    { name: "Bional (قرار لجنة)", unit: "10 T", price: 12 },
    { name: "Biperidene 2mg", unit: "10 T", price: 12 },
    { name: "Bisoprolol 2.5mg", unit: "10 T", price: 12 },
    { name: "Bisoprolol 5mg", unit: "10 T", price: 12 },
    { name: "Bisoprolol 5mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Bleomycin 15 I.U", unit: "Vial", price: 12 },
    { name: "Bosentan 62.5mg", unit: "10 T", price: 12 },
    { name: "Brimonidine ED", unit: "B", price: 12 },
    { name: "Budesonide 160mcg & Formoterol 4.5mcg", unit: "B", price: 12 },
    { name: "Bumetanide", unit: "10 T", price: 12 },
    { name: "Cabergoline 0.5mg", unit: "2 T", price: 12 },
    { name: "Caelyx", unit: "Vial", price: 12 },
    { name: "Calamine & Antihistamine Lotion", unit: "B", price: 12 },
    { name: "Calcium 500mg", unit: "10 T", price: 12 },
    { name: "Candesartan 16 mg", unit: "10 T", price: 12 },
    { name: "Candesartan 16mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Candesartan 8mg", unit: "10 T", price: 12 },
    { name: "Capecitabine 500mg", unit: "T", price: 12 },
    { name: "Capoten 25mg (حكم قضائي)", unit: "10 T", price: 12 },
    { name: "Captopril 50mg & HCT 25mg", unit: "10 T", price: 12 },
    { name: "Carbamazepin 200mg", unit: "10 T", price: 12 },
    { name: "Carbamazepin 400mg CR", unit: "10 T", price: 12 },
    { name: "Carbamide cream", unit: "Tube", price: 12 },
    { name: "Carbimazole 5mg", unit: "10 T", price: 12 },
    { name: "Carboplatin 150mg", unit: "Vial", price: 12 },
    { name: "Carboplatin 450mg", unit: "Vial", price: 12 },
    { name: "Carfilzomib 60mg", unit: "Vial", price: 12 },
    { name: "Carvedilol 12.5mg", unit: "10T", price: 12 },
    { name: "Carvedilol 25mg", unit: "10 T", price: 12 },
    { name: "Carvedilol 6.25mg", unit: "10 T", price: 12 },
    { name: "Celecoxib 200mg", unit: "10 T", price: 12 },
    { name: "Central Muscle Relaxant & Analgesic", unit: "10 T", price: 12 },
    { name: "Cephalexine 500", unit: "10 Cap", price: 12 },
    { name: "Cetirizine", unit: "10 T", price: 12 },
    { name: "Cetuximab 100mg", unit: "Vial", price: 12 },
    { name: "Chlorpromazine 100mg", unit: "10 T", price: 12 },
    { name: "Cholecalciferol 10000IU", unit: "10 T", price: 12 },
    { name: "Cholestyramine Sachets", unit: "12 Sach", price: 12 },
    { name: "Chymotrypsin & Trypsin", unit: "10 T", price: 12 },
    { name: "Cidophage 850mg (حكم قضائي)", unit: "10 T", price: 12 },
    { name: "Cilostazole 100mg", unit: "10 T", price: 12 },
    { name: "Cilostazole 50mg", unit: "10 T", price: 12 },
    { name: "Cinacalcet 30mg", unit: "10 T", price: 12 },
    { name: "Cinchocaine & Hydrocortisone Supp", unit: "6 Supp", price: 12 },
    { name: "Cinchocaine & Hydrocortisone cream", unit: "Tube", price: 12 },
    { name: "Cinnarizine 25mg", unit: "10 T", price: 12 },
    { name: "Cipralex 10mg (تم الصرف بالاسم التجاري وفقا لتأشيرة الشئون الطبية)", unit: "14 T", price: 12 },
    { name: "Ciprapro (استثناء مدير الفرع)", unit: "10 T", price: 12 },
    { name: "Ciprofloxacin 500mg", unit: "10 T", price: 12 },
    { name: "Citalopram 20mg", unit: "7 T", price: 12 },
    { name: "Citicoline 500mg", unit: "Amp", price: 12 },
    { name: "Citicoline Syp", unit: "B", price: 12 },
    { name: "Clobetasol Cream", unit: "Tube", price: 12 },
    { name: "Clomipramine 25mg", unit: "10 T", price: 12 },
    { name: "Clomipramine 75mg", unit: "10 T", price: 12 },
    { name: "Clopidogrel 75mg", unit: "10 T", price: 12 },
    { name: "Clotrimazole Cream", unit: "Tube", price: 12 },
    { name: "Clotrimazole Soln.", unit: "B", price: 12 },
    { name: "Clozapine 100mg", unit: "10 T", price: 12 },
    { name: "Colchicine", unit: "10 T", price: 12 },
    { name: "Cough Sedative", unit: "B", price: 12 },
    { name: "Cyclosporin 50mg", unit: "10 T", price: 12 },
    { name: "Cytarabine 1gm", unit: "Vial", price: 12 },
    { name: "Dapagliflozin 10mg", unit: "10 T", price: 12 },
    { name: "Dapagliflozin 10mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Dapagliflozin 5mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Darbepoetin Alpha (لجنه عليا)", unit: "Syringe", price: 12 },
    { name: "Deferoxamine 500mg", unit: "Amp", price: 12 },
    { name: "Dexamethasone , Neomycine & Polimyxin ED", unit: "B", price: 12 },
    { name: "Dexamethasone , Neomycine & Polimyxin EO", unit: "Tube", price: 12 },
    { name: "Diacerein 50mg", unit: "10 T", price: 12 },
    { name: "Diamicron MR (حكم قضائي)", unit: "30 T", price: 12 },
    { name: "Diclofenac 100mg supp", unit: "5 Supp", price: 12 },
    { name: "Diclofenac 75mg amp", unit: "Amp", price: 12 },
    { name: "Diclofenac gel", unit: "Tube", price: 12 },
    { name: "Diclofenac sodium 50mg", unit: "10 T", price: 12 },
    { name: "Digestive", unit: "10 T", price: 12 },
    { name: "Digestive Syp", unit: "B", price: 12 },
    { name: "Digoxine 0.25mg", unit: "10 T", price: 12 },
    { name: "Diltiazem 60mg", unit: "10 T", price: 12 },
    { name: "Diltiazem 90mg", unit: "10T", price: 12 },
    { name: "Diosmin 450mg & Hesperidin 50mg", unit: "10 T", price: 12 },
    { name: "Domperidone 10mg", unit: "10 T", price: 12 },
    { name: "Dorzolamide & Timolol ED", unit: "B", price: 12 },
    { name: "Dostenix (حكم قضائي)", unit: "2 T", price: 12 },
    { name: "Dothiepin 25mg", unit: "10 T", price: 12 },
    { name: "Dothiepin 75mg", unit: "10 T", price: 12 },
    { name: "Doxazosin 1mg", unit: "10 T", price: 12 },
    { name: "Doxazosin 4mg", unit: "10 T", price: 12 },
    { name: "Doxorubicin 20mg", unit: "Vial", price: 12 },
    { name: "Doxycycline 100mg", unit: "10 Cap", price: 12 },
    { name: "Duloxetine 30mg", unit: "10 T", price: 12 },
    { name: "Dydrogesterone 10mg", unit: "10 T", price: 12 },
    { name: "Empagliflozin 12.5mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Empagliflozin 25mg", unit: "10 T", price: 12 },
    { name: "Empagliflozin 25mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Empagliflozin 5mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Enalapril 20mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Endoxan 1g", unit: "Vial", price: 12 },
    { name: "Endoxan 50mg", unit: "50T", price: 12 },
    { name: "Enoxaparin 20mg", unit: "Syringe", price: 12 },
    { name: "Enoxaparin 40mg", unit: "Syringe", price: 12 },
    { name: "Enoxaparin 60mg", unit: "Syringe", price: 12 },
    { name: "Enoxaparin 80mg", unit: "Syringe", price: 12 },
    { name: "Entecavir 0.5mg", unit: "10 T", price: 12 },
    { name: "Entecavir 1mg", unit: "10 T", price: 12 },
    { name: "Erythropoietin alpha 4000IU", unit: "Vial", price: 12 },
    { name: "Escitalopram 10mg", unit: "14T", price: 12 },
    { name: "Esomeprazole 40 mg", unit: "10 Cap", price: 12 },
    { name: "Estradiol Valerate & Norgestrel", unit: "21 T", price: 12 },
    { name: "Ethamsylate 250 mg", unit: "10 T", price: 12 },
    { name: "Etoposide 100mg", unit: "Amp", price: 12 },
    { name: "Etoricoxib 120mg", unit: "10 T", price: 12 },
    { name: "Etoricoxib 90mg", unit: "10 T", price: 12 },
    { name: "Famotidine 20 mg", unit: "10 T", price: 12 },
    { name: "Famotidine 40mg", unit: "10 T", price: 12 },
    { name: "Febuxostat 40mg", unit: "10 T", price: 12 },
    { name: "Febuxostat 80mg", unit: "10 T", price: 12 },
    { name: "Fenofibrate 300mg", unit: "10 T", price: 12 },
    { name: "Ferro Sanol Duodenal (موافقة الشئون الطبية)", unit: "30 T", price: 12 },
    { name: "Fexofenadine 120mg", unit: "10 T", price: 12 },
    { name: "Fexofenadine 180mg", unit: "10 T", price: 12 },
    { name: "Flavoxate 200mg", unit: "10 T", price: 12 },
    { name: "Fluconazole 150mg", unit: "1 T", price: 12 },
    { name: "Fluoxetine 20mg", unit: "10 T", price: 12 },
    { name: "Fluticasone 125mcg & Salmeterol 25mcg", unit: "B", price: 12 },
    { name: "Folic acid", unit: "10 T", price: 12 },
    { name: "Formoterol", unit: "30 T", price: 12 },
    { name: "Fucidic Acid Cream", unit: "Tube", price: 12 },
    { name: "Furosemide 20mg & Spironolactone 50mg", unit: "10 T", price: 12 },
    { name: "Furosemide 40mg", unit: "10 T", price: 12 },
    { name: "Gabapentin 100mg", unit: "10 T", price: 12 },
    { name: "Gabapentin 400mg", unit: "10 T", price: 12 },
    { name: "Galvus 50mg (حكم قضائي )", unit: "28 T", price: 12 },
    { name: "Gastrobiotic 550mg (لجنه عليا)", unit: "10 T", price: 12 },
    { name: "Gentamicin 80mg", unit: "Amp", price: 12 },
    { name: "Gentamicin Cream", unit: "Tube", price: 12 },
    { name: "Gilenya 0.5mg", unit: "28 Cap", price: 12 },
    { name: "Ginkgo biloba", unit: "10 T", price: 12 },
    { name: "Glibenclamide 5mg", unit: "10 T", price: 12 },
    { name: "Glibenclamide 5mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Glibenclamide 5mg & Met. 500mg", unit: "10 T", price: 12 },
    { name: "Gliclazide 60mg", unit: "10 T", price: 12 },
    { name: "Glimepiride 2mg", unit: "10 T", price: 12 },
    { name: "Glimepiride 2mg & Met. 1000mg", unit: "10 T", price: 12 },
    { name: "Glimepiride 3mg", unit: "10 T", price: 12 },
    { name: "Glimepiride 4mg", unit: "10 T", price: 12 },
    { name: "Glucosamine", unit: "10 T", price: 12 },
    { name: "Gramicidin, Neomycin, Nystatin & Triamcinolone Cream", unit: "Tube", price: 12 },
    { name: "Haloperidol 5 mg", unit: "10 T", price: 12 },
    { name: "Haloperidol 5mg", unit: "Amp", price: 12 },
    { name: "Hexamine, Khellin & Piperazin Sachets", unit: "12 Sach", price: 12 },
    { name: "Human chorionic gonadotropin", unit: "Amp", price: 12 },
    { name: "Hydroxychloroquine", unit: "10 T", price: 12 },
    { name: "Hydroxyurea", unit: "10 T", price: 12 },
    { name: "Ibuprofen 200mg", unit: "10 T", price: 12 },
    { name: "Imipramine 25mg", unit: "10 T", price: 12 },
    { name: "Indepamid 2.5 mg", unit: "10 T", price: 12 },
    { name: "Indomethacin 100mg Supp.", unit: "10 Supp", price: 12 },
    { name: "Insulin Isophane Protamine", unit: "Penfill", price: 12 },
    { name: "Insulin Isophane Protamine", unit: "Vial", price: 12 },
    { name: "Insulin Mix 70/30 (Insulin Isophane Protamine & Insulin Neutral Human)", unit: "Penfill", price: 12 },
    { name: "Insulin Mix 70/30 (Insulin Isophane Protamine & Insulin Neutral Human)", unit: "Vial", price: 12 },
    { name: "Insulin Neutral Human", unit: "Penfill", price: 12 },
    { name: "Insulin Neutral Human", unit: "Vial", price: 12 },
    { name: "Invega 100mg (قرار لجنة)", unit: "Syringe", price: 12 },
    { name: "Invega 150mg (قرار لجنة)", unit: "Syringe", price: 12 },
    { name: "Ipratropium & Salbutamol", unit: "Amp", price: 12 },
    { name: "Irinotecan 100mg", unit: "Vial", price: 12 },
    { name: "Iron", unit: "10 T", price: 12 },
    { name: "Iruxol", unit: "Tube", price: 12 },
    { name: "Isosorbide Mononitrate 20mg", unit: "10 T", price: 12 },
    { name: "Ivabradine 5mg", unit: "10 T", price: 12 },
    { name: "Ivabradine 7.5mg", unit: "10 T", price: 12 },
    { name: "Ketoprofen 50mg", unit: "10 T", price: 12 },
    { name: "Ketosteril", unit: "100 T", price: 12 },
    { name: "Ketotifen", unit: "10 T", price: 12 },
    { name: "L-Carnitine Amp", unit: "Amp", price: 12 },
    { name: "L-Carnitine Cap", unit: "10 Cap", price: 12 },
    { name: "Lacosamide 100 mg", unit: "10 T", price: 12 },
    { name: "Lactulose Syp", unit: "B", price: 12 },
    { name: "Lamivudine", unit: "10 T", price: 12 },
    { name: "Lamotrigine 100mg", unit: "10 T", price: 12 },
    { name: "Lamotrigine 50mg", unit: "10 T", price: 12 },
    { name: "Latanoprost ED", unit: "B", price: 12 },
    { name: "Laxative", unit: "10 T", price: 12 },
    { name: "Leflunomide 20mg", unit: "10 T", price: 12 },
    { name: "Lercanidipine 10mg", unit: "10 T", price: 12 },
    { name: "Leucovorin Calcium 50mg", unit: "Amp", price: 12 },
    { name: "Levetiracetam 1000mg", unit: "10 T", price: 12 },
    { name: "Levetiracetam 500mg", unit: "10 T", price: 12 },
    { name: "Levodopa & Carbidopa 250/25mg", unit: "10 T", price: 12 },
    { name: "Levodopa, Carbidopa & Entacapone 150/37.5/200mg", unit: "10 T", price: 12 },
    { name: "Levofloxacin 500mg", unit: "10 T", price: 12 },
    { name: "Levothyroxine 100mcg", unit: "100 T", price: 12 },
    { name: "Levothyroxine 25mcg", unit: "50 T", price: 12 },
    { name: "Levothyroxine 50mcg", unit: "100 T", price: 12 },
    { name: "Lidocaine cream", unit: "Tube", price: 12 },
    { name: "Linezolid 600 mg", unit: "10 T", price: 12 },
    { name: "Lisinopril 10mg", unit: "10 T", price: 12 },
    { name: "Lithium Carbonate 400mg", unit: "10 T", price: 12 },
    { name: "Lolawest (قرار لجنة)", unit: "6 Sach", price: 12 },
    { name: "Long Acting Penicillin", unit: "Vial", price: 12 },
    { name: "Losartan 50mg", unit: "10 T", price: 12 },
    { name: "Losartan 50mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Magnesium Citrate Eff.", unit: "12 Sach", price: 12 },
    { name: "Mayzent 0.25 mg (لجنة)", unit: "12 T", price: 12 },
    { name: "Mebeverine 100mg & Sulpiride 25mg", unit: "10 T", price: 12 },
    { name: "Meclofenoxate 500mg", unit: "10 T", price: 12 },
    { name: "Memantine 10 mg", unit: "10 T", price: 12 },
    { name: "Mesalazine 500mg", unit: "10 T", price: 12 },
    { name: "Mesalazine Supp", unit: "28 Supp", price: 12 },
    { name: "Metformin 500mg", unit: "10 T", price: 12 },
    { name: "Metformin 850mg", unit: "10 T", price: 12 },
    { name: "Methotrexate", unit: "Vial", price: 12 },
    { name: "Methotrexate 2.5mg", unit: "10 T", price: 12 },
    { name: "Methyl Folate (لجنة دواء)", unit: "10 T", price: 12 },
    { name: "Methyldopa 250mg", unit: "10 T", price: 12 },
    { name: "Metoclopramide 10mg", unit: "10 T", price: 12 },
    { name: "Metoprolol 100mg", unit: "10 T", price: 12 },
    { name: "Metoprolol 50mg", unit: "10 T", price: 12 },
    { name: "Metronidazole 250mg", unit: "10 T", price: 12 },
    { name: "Miconazole vaginal cream", unit: "Tube", price: 12 },
    { name: "Minirin 60mcg (قرار لجنة)", unit: "30T", price: 12 },
    { name: "Mometasone Cream", unit: "Tube", price: 12 },
    { name: "Montelukast 10mg", unit: "10 T", price: 12 },
    { name: "Mouth Wash", unit: "B", price: 12 },
    { name: "Multivitamins", unit: "10 Cap", price: 12 },
    { name: "Mycophenolate 180mg", unit: "10 T", price: 12 },
    { name: "Mycophenolate 500mg", unit: "10 T", price: 12 },
    { name: "N-plate", unit: "Syringe", price: 12 },
    { name: "Naftidrofuryl 200mg", unit: "10 T", price: 12 },
    { name: "Naphazoline & Chlorpheniramine ED", unit: "B", price: 12 },
    { name: "Napizole 20mg (حكم قضائي )", unit: "14 T", price: 12 },
    { name: "Navelbin 20mg", unit: "T", price: 12 },
    { name: "Nebivolol 2.5mg", unit: "10 T", price: 12 },
    { name: "Nebivolol 5mg", unit: "10 T", price: 12 },
    { name: "Nebivolol 5mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Nebivolol 5mg & HCT 25mg", unit: "10 T", price: 12 },
    { name: "Neostigmine 15mg", unit: "10 T", price: 12 },
    { name: "Nicorandil 10mg", unit: "10 T", price: 12 },
    { name: "Nicorandil 20mg", unit: "10 T", price: 12 },
    { name: "Nifedipine", unit: "10 T", price: 12 },
    { name: "Nitroglycerin 2.5mg", unit: "10 Cap", price: 12 },
    { name: "Nitroglycerin 5mg Patches", unit: "Patch", price: 12 },
    { name: "Nitromak 2.5mg (حكم قضائي)", unit: "10 T", price: 12 },
    { name: "Norethisterone", unit: "10 T", price: 12 },
    { name: "Ofev (حكم قضائي)", unit: "60 T", price: 12 },
    { name: "Olanzapine 10mg", unit: "10 T", price: 12 },
    { name: "Olmesartan 20mg", unit: "10 T", price: 12 },
    { name: "Olmesartan 20mg & HCT 12.5mg", unit: "10 T", price: 12 },
    { name: "Olmesartan 40mg", unit: "10 T", price: 12 },
    { name: "Omega 3", unit: "10 T", price: 12 },
    { name: "Omeprazole 20mg", unit: "7 T", price: 12 },
    { name: "Omeprazole 40mg", unit: "10 T", price: 12 },
    { name: "Opsumit 10mg", unit: "30 T", price: 12 },
    { name: "Oxcarbazepine 300mg", unit: "10 T", price: 12 },
    { name: "Oxybutynin 5mg", unit: "10 T", price: 12 },
    { name: "Panthenol cream", unit: "Tube", price: 12 },
    { name: "Pantoprazole 20mg", unit: "10 T", price: 12 },
    { name: "Pantoprazole 40mg", unit: "10 T", price: 12 },
    { name: "Paracetamol 500mg", unit: "10 T", price: 12 },
    { name: "Pentasa (لجنة عليا)", unit: "10 T", price: 12 },
    { name: "Pentasa Supp (لجنة عليا)", unit: "28 Supp", price: 12 },
    { name: "Pentoxifylline 400mg", unit: "10 T", price: 12 },
    { name: "Phenytoin 100mg", unit: "10 T", price: 12 },
    { name: "Phenytoin 50mg", unit: "10 T", price: 12 },
    { name: "Pimozide 4mg", unit: "10 T", price: 12 },
    { name: "Piracetam 400mg", unit: "10 T", price: 12 },
    { name: "Piracetam 800mg", unit: "10 T", price: 12 },
    { name: "Piracetam Syp", unit: "B", price: 12 },
    { name: "Pirfenex (حكم قضائي)", unit: "30 T", price: 12 },
    { name: "Pirfenidone 200mg (قرار لجنة )", unit: "30 T", price: 12 },
    { name: "Piroxicam 10mg", unit: "10 T", price: 12 },
    { name: "Piroxicam 20mg", unit: "10 T", price: 12 },
    { name: "Plendil 5mg (موافقة الشئون الطبية)", unit: "30 T", price: 12 },
    { name: "Ponvory (Ponesimod 20 mg) (قرار لجنة)", unit: "28 T", price: 12 },
    { name: "Potassium", unit: "B", price: 12 },
    { name: "Povidone Iodine Shampoo", unit: "B", price: 12 },
    { name: "Pramipexol 0.25mg", unit: "10 T", price: 12 },
    { name: "Pramipexol 1 mg", unit: "10 T", price: 12 },
    { name: "Prednisolone 20mg", unit: "10 T", price: 12 },
    { name: "Prednisolone 5mg", unit: "10 T", price: 12 },
    { name: "Prednisolone ED", unit: "B", price: 12 },
    { name: "Progesteron 100mg", unit: "10 Cap", price: 12 },
    { name: "Progesteron 250mg", unit: "Amp", price: 12 },
    { name: "Propafenone 150mg", unit: "10 T", price: 12 },
    { name: "Propolis, Chamomile, Zinc Oxide & Honey Cream", unit: "Tube", price: 12 },
    { name: "Propranolol 10mg", unit: "10 T", price: 12 },
    { name: "Propranolol 40mg", unit: "10 T", price: 12 },
    { name: "Propylthiouracil 50mg", unit: "10 T", price: 12 },
    { name: "Pyridostigmine 60mg", unit: "10 T", price: 12 },
    { name: "Quetiapine 100mg", unit: "10 T", price: 12 },
    { name: "Quinidine sulphate 250mg", unit: "10T", price: 12 },
    { name: "Ramipril 10mg", unit: "10 T", price: 12 },
    { name: "Ramipril 2.5 mg", unit: "10 T", price: 12 },
    { name: "Ramipril 5mg", unit: "10T", price: 12 },
    { name: "Ramipril 5mg & Felodipine 5mg", unit: "10 T", price: 12 },
    { name: "Rasagiline 1mg", unit: "10 T", price: 12 },
    { name: "Rebamipide", unit: "10 T", price: 12 },
    { name: "Rebif 44mcg (قرار لجنة)", unit: "Syringe", price: 12 },
    { name: "Rilutek (قرار لجنة)", unit: "56 T", price: 12 },
    { name: "Riluzole 50mg", unit: "56 T", price: 12 },
    { name: "Risperidone 1 mg", unit: "10 T", price: 12 },
    { name: "Risperidone 2 mg", unit: "10 T", price: 12 },
    { name: "Risperidone 3 mg", unit: "10 T", price: 12 },
    { name: "Rivaroxaban 10mg", unit: "10 T", price: 12 },
    { name: "Rivaroxaban 15mg", unit: "10 T", price: 12 },
    { name: "Rivaroxaban 20mg", unit: "10 T", price: 12 },
    { name: "Rivaroxban 2.5mg", unit: "10 T", price: 12 },
    { name: "Rosuvastatin 20mg", unit: "10 T", price: 12 },
    { name: "Rutin & Vit.C", unit: "10 T", price: 12 },
    { name: "Salbutamol", unit: "10 T", price: 12 },
    { name: "Salbutamol Inhaler", unit: "B", price: 12 },
    { name: "Salbutamol Syp", unit: "B", price: 12 },
    { name: "Sandostatin LAR", unit: "Syringe", price: 12 },
    { name: "Sertraline 50 mg", unit: "10 T", price: 12 },
    { name: "Sildenafil 20mg", unit: "10 T", price: 12 },
    { name: "Sildenafil 50mg", unit: "10 T", price: 12 },
    { name: "Sirolimus 1gm", unit: "10 T", price: 12 },
    { name: "Sitagliptin 100mg", unit: "10 T", price: 12 },
    { name: "Sitagliptin 50 mg & Met. 1000 mg", unit: "10 T", price: 12 },
    { name: "Sodium Valproate 200mg", unit: "10 T", price: 12 },
    { name: "Sodium Valproate 500mg", unit: "10 T", price: 12 },
    { name: "Solifenacin 10mg", unit: "10 T", price: 12 },
    { name: "Spiramycin 3MIU Tab", unit: "10 T", price: 12 },
    { name: "Spironolactone 100 mg", unit: "10 T", price: 12 },
    { name: "Spironolactone 25mg", unit: "10 T", price: 12 },
    { name: "Stivarga 40mg", unit: "84T", price: 12 },
    { name: "Sulphamethoxazole & Trimethoprim", unit: "10 T", price: 12 },
    { name: "Tacrolimus 1mg", unit: "10 T", price: 12 },
    { name: "Tadalafil 5 mg", unit: "10 T", price: 12 },
    { name: "Tamoxifen 10mg", unit: "10 T", price: 12 },
    { name: "Tamsulosin 0.4mg", unit: "14T", price: 12 },
    { name: "Tenofenamide 25mg", unit: "10 T", price: 12 },
    { name: "Tenofovir 300mg", unit: "30 T", price: 12 },
    { name: "Terbinafine 0.01 Cream", unit: "Tube", price: 12 },
    { name: "Terbutaline", unit: "10 T", price: 12 },
    { name: "Testosterone", unit: "Amp", price: 12 },
    { name: "Tetracosactrin", unit: "Amp", price: 12 },
    { name: "Theophylline 300mg", unit: "10 T", price: 12 },
    { name: "Thrombonorm 0.5mg (لجنة عليا)", unit: "100 Cap", price: 12 },
    { name: "Tiratam 1000 mg (تم الصرف بالاسم التجاري وفقا لتأشيرة الشئون الطبية)", unit: "10 T", price: 12 },
    { name: "Tiratam 500mg (استثناء من مدير الفرع)", unit: "10 T", price: 12 },
    { name: "Topiramate 100 mg", unit: "10 T", price: 12 },
    { name: "Topiramate 25 mg", unit: "10 T", price: 12 },
    { name: "Torsemide 20mg", unit: "10 T", price: 12 },
    { name: "Tranexamic acid 500mg", unit: "10 T", price: 12 },
    { name: "Travoprost ED", unit: "B", price: 12 },
    { name: "Triamcinilone 40mg", unit: "Amp", price: 12 },
    { name: "Trifluperazine 5mg (Stellasil)", unit: "10 T", price: 12 },
    { name: "Trimebutine 200mg", unit: "10 T", price: 12 },
    { name: "Trimetazidine 20mg", unit: "10 T", price: 12 },
    { name: "Urinex", unit: "12 Cap", price: 12 },
    { name: "Ursodeoxycholic acid 250mg", unit: "10 Cap", price: 12 },
    { name: "Valcyte 450mg", unit: "60 T", price: 12 },
    { name: "Valsartan 160mg", unit: "10T", price: 12 },
    { name: "Valsartan 160mg & Amlodipine 10mg", unit: "10 T", price: 12 },
    { name: "Valsartan 160mg & Amlodipine 5mg", unit: "10 T", price: 12 },
    { name: "Valsartan 160mg & HCT 25mg", unit: "10 T", price: 12 },
    { name: "Valsartan 40 mg", unit: "10 T", price: 12 },
    { name: "Vastarel MR ( حكم قضائي )", unit: "30 T", price: 12 },
    { name: "Verapamil 240mg", unit: "10 T", price: 12 },
    { name: "Verapamil 80mg", unit: "10 T", price: 12 },
    { name: "Vidaza 100mg", unit: "Vial", price: 12 },
    { name: "Vildagliptin 50mg", unit: "10 T", price: 12 },
    { name: "Vildagliptin 50mg & Metformin 1000mg", unit: "10 T", price: 12 },
    { name: "Vildagliptin 50mg & Metformin 850mg", unit: "10 T", price: 12 },
    { name: "Vildagluse plus 50/1000mg (حكم قضائي )", unit: "30 T", price: 12 },
    { name: "Vinblastin 10mg", unit: "vial", price: 12 },
    { name: "Vincamine 30mg", unit: "10 T", price: 12 },
    { name: "Vincristine 1mg", unit: "Vial", price: 12 },
    { name: "Vinorelbine 50mg", unit: "Vial", price: 12 },
    { name: "Vitamin A", unit: "10 T", price: 12 },
    { name: "Vitamin B amp", unit: "Amp", price: 12 },
    { name: "Vitamin B comp", unit: "10 T", price: 12 },
    { name: "Vitamin E 400", unit: "12 Cap", price: 12 },
    { name: "Vitamin K", unit: "10 T", price: 12 },
    { name: "Voriconazole 50mg", unit: "10 T", price: 12 },
    { name: "Warfarin 1mg", unit: "10 T", price: 12 },
    { name: "Warfarin 3mg", unit: "10 T", price: 12 },
    { name: "Warfarin 5 mg", unit: "10 T", price: 12 },
    { name: "Xarelto 15 mg (قرار لجنة)", unit: "42 T", price: 12 },
    { name: "Xarelto 20mg", unit: "28 T", price: 12 },
    { name: "Xgeva", unit: "Vial", price: 12 },
    { name: "Zoledronic 4mg", unit: "Vial", price: 12 }
];

const pharmacyOptions = {
    student: {
        first: [
            { name: "ابو المطامير طلاب", id: "a11" },
            { name: "ادكو طلاب", id: "a12" },
            { name: "البيضا طلاب", id: "a13" },
            { name: "النوبارية طلاب", id: "a14" },
            { name: "رشيد طلاب", id: "a15" },
            { name: "كفر الدوار طلاب", id: "a16" }
        ],
        second: [
            { name: "ابو حمص طلاب", id: "a21" },
            { name: "اورام طلاب", id: "a22" },
            { name: "الرحمانية طلاب", id: "a23" },
            { name: "المحمودية طلاب", id: "a24" },
            { name: "حوش عيسي طلاب", id: "a25" },
            { name: "دمنهور طلاب", id: "a26" }
        ],
        third: [
            { name: "ايتاي طلاب", id: "a31" },
            { name: "بدر طلاب", id: "a32" },
            { name: "الدلنجات طلاب", id: "a33" },
            { name: "كوم حمادة طلاب", id: "a34" },
            { name: "شبراخيت طلاب", id: "a35" }
        ]
    },
    workforce: {
        first: [
           { name: "ابو المطامير", id: "b11" },
            { name: "ادكو", id: "b12" },
            { name: "البيضا", id: "b13" },
            { name: "النوبارية", id: "b14" },
            { name: "رشيد", id: "b15" },
            { name: "كفر الدوار سكر", id: "b16" },
            { name: "كفر الدوار الشاملة 1", id: "b17" },
            { name: "كفر الدوار الشاملة 2", id: "b18" },
            { name: "كفر الدوار مسائي", id: "b19" }
        ],
        second: [
            { name: "ابو حمص", id: "b21" },
            { name: "الرحمانية", id: "b22" },
            { name: "المحمودية", id: "b23" },
            { name: "حوش عيسي", id: "b24" },
            { name: "دمنهور الشاملة 1", id: "b25" },
            { name: "دمنهور الشاملة 2", id: "b26" },
            { name: "دمنهور سكر", id: "b27" },
            { name: "دمنهور مسائي", id: "b28" },
            { name: "دمنهور اورام", id: "b29" },
            { name: "الشرطة", id: "b210" }
        ],
        third: [
            { name: "ايتاي الشاملة 1", id: "b31" },
            { name: "ايتاي الشاملة 2", id: "b32" },
            { name: "ايتاي مسائي", id: "b33" },
            { name: "بدر", id: "b34" },
            { name: "الدلنجات", id: "b35" },
            { name: "كوم حمادة", id: "b36" },
            { name: "كوم حمادة مسائي", id: "b37" },
            { name: "شبراخيت", id: "b38" },
            { name: "قليشان", id: "b39" },
            { name: "وادي النطرون", id: "b310" }
        ]
    }
};

const fuseOptions = {
    keys: ['name'],
    includeScore: true,
    threshold: 0.4,
    minMatchCharLength: 2
};
const fuse = new Fuse(items, fuseOptions);

// Event Listeners
idInput.addEventListener('input', autoFillFromId);
classButtons.forEach(btn => {
    btn.addEventListener('click', () => {
        if (!isSubmitting) {
            classButtons.forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedClass = btn.dataset.class;
            updatePharmacies();
            renderPharmacyList();
        }
    });
});

regionSelect.addEventListener('change', () => {
    if (!isSubmitting) {
        updatePharmacies();
        renderPharmacyList();
    }
});
nextBtn.addEventListener('click', () => {
    screen1.classList.add('hidden');
    screen2.classList.remove('hidden');
});
backBtn.addEventListener('click', () => {
    screen2.classList.add('hidden');
    screen1.classList.remove('hidden');
});

// Implement a more advanced debounce function
const debounce = (func, wait, immediate) => {
    let timeout;
    return function() {
        const context = this, args = arguments;
        const later = () => {
            timeout = null;
            if (!immediate) func.apply(context, args);
        };
        const callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
    };
};

// Use the advanced debounce for search
const debouncedHandleSearch = debounce(handleSearch, 100);
searchBar.addEventListener('input', (e) => {
    if (!isSubmitting) {
        debouncedHandleSearch(e);
    }
});

submitBtn.addEventListener('click', validateAndSubmit);

// Functions
function autoFillFromId() {
    if (isSubmitting) return;
    
    const id = idInput.value;
    if (id.length >= 3) {
        const classType = id[0] === 'a' ? 'student' : 'workforce';
        const regionMap = {
            '1': 'first',
            '2': 'second',
            '3': 'third'
        };
        let region = regionMap[id[1]];
        
        if (!region && id.length === 4) {
            if (id.startsWith('b21')) region = 'second';
            else if (id.startsWith('b31')) region = 'third';
        }
        
        if (!region) return; // Invalid ID format
        
        selectedClass = classType;
        classButtons.forEach(btn => {
            btn.classList.toggle('selected', btn.dataset.class === classType);
        });
        
        regionSelect.value = region;
        updatePharmacies();
        renderPharmacyList();
        
        const pharmacy = pharmacyOptions[classType][region].find(p => p.id === id);
        if (pharmacy) {
            pharmacySelect.value = pharmacy.name;
        }
    }
}

function updatePharmacies() {
    const region = regionSelect.value;
    const options = ['<option value="" disabled selected>Select Pharmacy</option>'];
    if (region && selectedClass) {
        pharmacyOptions[selectedClass][region].forEach(pharmacy => {
            options.push(`<option value="${pharmacy.name}">${pharmacy.name}</option>`);
        });
    }
    pharmacySelect.innerHTML = options.join('');
}

function renderPharmacyList() {
    const fragment = document.createDocumentFragment();
    if (selectedClass && regionSelect.value) {
        pharmacyOptions[selectedClass][regionSelect.value].forEach(pharmacy => {
            const div = document.createElement('div');
            div.className = 'pharmacy-item';
            div.textContent = `${pharmacy.name} (${pharmacy.id})`;
            div.addEventListener('click', () => {
                if (!isSubmitting) {
                    idInput.value = pharmacy.id;
                    autoFillFromId();
                }
            });
            fragment.appendChild(div);
        });
    }
    pharmacyList.innerHTML = '';
    pharmacyList.appendChild(fragment);
}

function handleSearch() {
    if (isSubmitting) return;

    const query = searchBar.value.trim();
    const suggestionsFragment = document.createDocumentFragment();
    const didYouMeanFragment = document.createDocumentFragment();

    suggestions.innerHTML = '';
    didYouMean.innerHTML = '';

    if (query.length === 0) return;

    const searchResults = fuse.search(query);
    
    if (searchResults.length > 0) {
        const selectedItemsSet = new Set(selectedItems.map(item => item.name));
        searchResults.slice(0, 5).forEach(({ item, score }) => {
            const div = document.createElement('div');
            div.innerHTML = `
                <strong>${highlightMatches(item.name, query)}</strong>
                <br>
                <small>${item.unit} - $${item.price}</small>
            `;
            div.addEventListener('click', () => {
                if (!isSubmitting) {
                    addItem(item);
                }
            });
            if (selectedItemsSet.has(item.name)) {
                div.classList.add('duplicate');
            }
            suggestionsFragment.appendChild(div);
        });
        suggestions.appendChild(suggestionsFragment);

        if (searchResults[0].score > 0.1) {
            const didYouMeanSuggestions = generateDidYouMeanSuggestions(searchResults);
            if (didYouMeanSuggestions.length > 0) {
                const didYouMeanHeader = document.createElement('div');
                didYouMeanHeader.textContent = 'Did you mean:';
                didYouMeanHeader.style.fontWeight = 'bold';
                didYouMeanFragment.appendChild(didYouMeanHeader);
                didYouMeanSuggestions.forEach(suggestion => {
                    const div = document.createElement('div');
                    div.textContent = suggestion;
                    div.addEventListener('click', () => {
                        if (!isSubmitting) {
                            searchBar.value = suggestion;
                            handleSearch();
                        }
                    });
                    didYouMeanFragment.appendChild(div);
                });
                didYouMean.appendChild(didYouMeanFragment);
            }
        }
    } else {
        suggestions.innerHTML = '<div>No results found</div>';
    }
}

function highlightMatches(text, query) {
    const words = query.toLowerCase().split(/\s+/).filter(word => word.length > 0);
    const regex = new RegExp(`(${words.map(word => word.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')).join('|')})`, 'gi');
    return text.replace(regex, '<span class="highlight">$1</span>');
}

function generateDidYouMeanSuggestions(searchResults) {
    const maxSuggestions = 5;
    const suggestions = new Set();
    const query = searchBar.value.toLowerCase();
    const metaphone = getMetaphone(query);

    for (const result of searchResults) {
        if (suggestions.size >= maxSuggestions) break;
        if (result.item.name.toLowerCase() !== query) {
            suggestions.add(result.item.name);
        }
    }

    if (suggestions.size < maxSuggestions) {
        for (const item of items) {
            if (suggestions.size >= maxSuggestions) break;
            if (!suggestions.has(item.name) && getMetaphone(item.name) === metaphone) {
                suggestions.add(item.name);
            }
        }
    }

    return Array.from(suggestions);
}

function getMetaphone(word) {
    return word.toLowerCase()
        .replace(/[aeiou]/g, '')
        .replace(/ph/g, 'f')
        .replace(/[bfpv]/g, '1')
        .replace(/[cgjkqsxz]/g, '2')
        .replace(/[dt]/g, '3')
        .replace(/[l]/g, '4')
        .replace(/[mn]/g, '5')
        .replace(/[r]/g, '6')
        .substr(0, 4);
}

function addItem(item) {
    if (isSubmitting) return;

    const existingItemIndex = selectedItems.findIndex(i => i.name === item.name);
    if (existingItemIndex === -1) {
        selectedItems.push({ ...item, unitsSold: 1 });
        renderTable();
        saveState();
    }
    searchBar.value = '';
    suggestions.innerHTML = '';
    didYouMean.innerHTML = '';
}

function renderTable() {
    dataTable.innerHTML = '';
    selectedItems.forEach((item, index) => {
        const row = dataTable.insertRow();
        row.insertCell(0).textContent = item.name;
        row.insertCell(1).textContent = item.unit;
        const unitsSoldCell = row.insertCell(2);
        unitsSoldCell.className = 'editable';
        const unitsSoldInput = document.createElement('input');
        unitsSoldInput.type = 'number';
        unitsSoldInput.value = item.unitsSold;
        unitsSoldInput.min = 1;
        unitsSoldInput.addEventListener('change', (e) => {
            if (!isSubmitting) {
                item.unitsSold = parseInt(e.target.value);
                saveState();
            } else {
                e.preventDefault();
            }
        });
        unitsSoldCell.appendChild(unitsSoldInput);
        const actionsCell = row.insertCell(3);
        const deleteBtn = document.createElement('button');
        deleteBtn.innerHTML = '<i class="material-icons">delete</i>';
        deleteBtn.addEventListener('click', () => {
            if (!isSubmitting) {
                selectedItems.splice(index, 1);
                renderTable();
                saveState();
            }
        });
        actionsCell.appendChild(deleteBtn);
    });
}

function saveState() {
    localStorage.setItem('pharmacyAppState', JSON.stringify({
        id: idInput.value,
        class: selectedClass,
        region: regionSelect.value,
        pharmacy: pharmacySelect.value,
        month: monthInput.value,
        items: selectedItems
    }));
}

function loadState() {
    const state = JSON.parse(localStorage.getItem('pharmacyAppState'));
    if (state) {
        idInput.value = state.id;
        selectedClass = state.class;
        classButtons.forEach(btn => {
            if (btn.dataset.class === state.class) {
                btn.classList.add('selected');
            }
        });
        regionSelect.value = state.region;
        updatePharmacies();
        renderPharmacyList();
        pharmacySelect.value = state.pharmacy;
        monthInput.value = state.month;
        selectedItems = state.items;
        renderTable();
    }
}

function validateAndSubmit() {
    if (isSubmitting) {
        console.log('Submission already in progress');
        return;
    }

    const hasUnitsSold = selectedItems.some(item => item.unitsSold > 0);
    const isClassSelected = selectedClass !== '';
    const isRegionSelected = regionSelect.value !== '';
    const isPharmacySelected = pharmacySelect.value !== '';
    const isMonthValid = monthInput.value !== '' && monthInput.value >= 1 && monthInput.value <= 12;

    if (hasUnitsSold && isClassSelected && isRegionSelected && isPharmacySelected && isMonthValid) {
        submitToFirebase();
    } else {
        let errorMessage = 'Please correct the following errors:\n';
        if (!hasUnitsSold) errorMessage += '- At least one item must have units sold\n';
        if (!isClassSelected) errorMessage += '- Please select a class\n';
        if (!isRegionSelected) errorMessage += '- Please select a region\n';
        if (!isPharmacySelected) errorMessage += '- Please select a pharmacy\n';
        if (!isMonthValid) errorMessage += '- Please enter a valid month (1-12)\n';
        alert(errorMessage);
    }
}

function submitToFirebase() {
    if (isSubmitting) {
        console.log('Submission already in progress');
        return;
    }
    
    isSubmitting = true;
    disableInputs();

    const flatData = {
        id: idInput.value,
        class: selectedClass,
        region: regionSelect.value,
        pharmacy: pharmacySelect.value,
        month: parseInt(monthInput.value),
        timestamp: firebase.database.ServerValue.TIMESTAMP
    };

    selectedItems.forEach((item, index) => {
        flatData[`item_${index + 1}_name`] = item.name;
        flatData[`item_${index + 1}_unit`] = item.unit;
        flatData[`item_${index + 1}_unitsSold`] = item.unitsSold;
        flatData[`item_${index + 1}_price`] = item.price;
    });
    
    console.log('Submitting data:', flatData);

    const key = `${flatData.pharmacy}_${flatData.month}`;
    
    db.ref('pharmacyInventory').child(key).set(flatData)
        .then(() => {
            alert('Data submitted successfully!');
            clearForm();
        })
        .catch((error) => {
            console.error("Error writing document: ", error);
            let errorMessage = 'An error occurred while submitting the data. ';
            if (!navigator.onLine) {
                errorMessage += 'It appears you are offline. Please check your internet connection and try again.';
            } else if (error.code === 'PERMISSION_DENIED') {
                errorMessage += 'A submission for this pharmacy and month already exists.';
            } else {
                errorMessage += 'Please try again later. If the problem persists, contact support.';
            }
            alert(errorMessage);
            console.log('Error details:', error);
        })
        .finally(() => {
            isSubmitting = false;
            enableInputs();
        });
}

function disableInputs() {
    const inputs = document.querySelectorAll('input, select, button');
    inputs.forEach(input => {
        if (input !== nextBtn && input !== backBtn) {
            input.disabled = true;
        }
    });
    submitBtn.textContent = 'Submitting...';
}

function enableInputs() {
    const inputs = document.querySelectorAll('input, select, button');
    inputs.forEach(input => {
        input.disabled = false;
    });
    submitBtn.textContent = 'Submit';
}

function clearForm() {
    idInput.value = '';
    selectedClass = '';
    classButtons.forEach(btn => btn.classList.remove('selected'));
    regionSelect.value = '';
    updatePharmacies();
    pharmacySelect.value = '';
    monthInput.value = '';
    selectedItems = [];
    renderTable();
    saveState();
    screen2.classList.add('hidden');
    screen1.classList.remove('hidden');
}

// Initialize
loadState();
renderPharmacyList();

</script>
</body>
</html>